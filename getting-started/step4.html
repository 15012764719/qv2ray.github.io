<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>让你的软件或浏览器走 Qv2ray 提供的代理 | Qv2ray</title>
    <meta name="description" content="🌟 V2Ray Linux / Windows / macOS 跨平台 GUI 🔨 使用 C++17 / Qt5 ，支持订阅，扫描二维码，支持自定义路由编辑 🌟">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="icon" href="/logo.png">
    
    <link rel="preload" href="/assets/css/0.styles.ec4d635c.css" as="style"><link rel="preload" href="/assets/js/app.30c44e32.js" as="script"><link rel="preload" href="/assets/js/2.18c3a4c2.js" as="script"><link rel="preload" href="/assets/js/24.6b6e4eef.js" as="script"><link rel="prefetch" href="/assets/js/10.cc2edb66.js"><link rel="prefetch" href="/assets/js/11.1cbacdd7.js"><link rel="prefetch" href="/assets/js/12.607a6ad1.js"><link rel="prefetch" href="/assets/js/13.6b47470e.js"><link rel="prefetch" href="/assets/js/14.485ed06c.js"><link rel="prefetch" href="/assets/js/15.caa0cbd2.js"><link rel="prefetch" href="/assets/js/16.b4841f08.js"><link rel="prefetch" href="/assets/js/17.bf53d270.js"><link rel="prefetch" href="/assets/js/18.0e8a67e8.js"><link rel="prefetch" href="/assets/js/19.d79792d8.js"><link rel="prefetch" href="/assets/js/20.4f0a4853.js"><link rel="prefetch" href="/assets/js/21.69abe3c2.js"><link rel="prefetch" href="/assets/js/22.97d98f61.js"><link rel="prefetch" href="/assets/js/23.47eb64de.js"><link rel="prefetch" href="/assets/js/25.62a32342.js"><link rel="prefetch" href="/assets/js/26.c6d7c309.js"><link rel="prefetch" href="/assets/js/27.e83ce041.js"><link rel="prefetch" href="/assets/js/28.dfd7b68d.js"><link rel="prefetch" href="/assets/js/29.43065b0c.js"><link rel="prefetch" href="/assets/js/3.4ed136c9.js"><link rel="prefetch" href="/assets/js/4.b6773c92.js"><link rel="prefetch" href="/assets/js/5.8858366b.js"><link rel="prefetch" href="/assets/js/6.d092d05f.js"><link rel="prefetch" href="/assets/js/7.a4c751de.js"><link rel="prefetch" href="/assets/js/8.00a71ff0.js"><link rel="prefetch" href="/assets/js/9.008446e1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ec4d635c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="Qv2ray" class="logo"> <span class="site-name can-hide">Qv2ray</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/getting-started/" class="nav-link router-link-active">
  起步
</a></div><div class="nav-item"><a href="/manual/" class="nav-link">
  用户手册
</a></div><div class="nav-item"><a href="/faq/" class="nav-link">
  FAQ
</a></div><div class="nav-item"><a href="/hacking/" class="nav-link">
  折腾
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/getting-started/step4.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/getting-started/step4.html" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/Qv2ray/Qv2ray" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/getting-started/" class="nav-link router-link-active">
  起步
</a></div><div class="nav-item"><a href="/manual/" class="nav-link">
  用户手册
</a></div><div class="nav-item"><a href="/faq/" class="nav-link">
  FAQ
</a></div><div class="nav-item"><a href="/hacking/" class="nav-link">
  折腾
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/getting-started/step4.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/getting-started/step4.html" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/Qv2ray/Qv2ray" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/getting-started/" class="sidebar-link">概要</a></li><li><a href="/getting-started/step1.html" class="sidebar-link">下载 Qv2ray</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/getting-started/step1.html#github-release-二进制文件" class="sidebar-link">GitHub Release 二进制文件</a></li><li class="sidebar-sub-header"><a href="/getting-started/step1.html#github-actions-编译版" class="sidebar-link">GitHub Actions 编译版</a></li><li class="sidebar-sub-header"><a href="/getting-started/step1.html#在包管理系统中安装此软件" class="sidebar-link">在包管理系统中安装此软件</a></li><li class="sidebar-sub-header"><a href="/getting-started/step1.html#从应用商店中获取" class="sidebar-link">从应用商店中获取</a></li><li class="sidebar-sub-header"><a href="/getting-started/step1.html#从源码编译" class="sidebar-link">从源码编译</a></li></ul></li><li><a href="/getting-started/step2.html" class="sidebar-link">配置 V2Ray 核心</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/getting-started/step2.html#下载-v2ray-核心文件" class="sidebar-link">下载 V2Ray 核心文件</a></li><li class="sidebar-sub-header"><a href="/getting-started/step2.html#放置你的-v2ray-核心" class="sidebar-link">放置你的 V2Ray 核心</a></li><li class="sidebar-sub-header"><a href="/getting-started/step2.html#配置-qv2ray-去使用核心" class="sidebar-link">配置 Qv2ray 去使用核心</a></li></ul></li><li><a href="/getting-started/step3.html" class="sidebar-link">向 Qv2ray 中导入节点</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/getting-started/step3.html#_1-通过-vmess-链接导入" class="sidebar-link">1. 通过 Vmess 链接导入</a></li><li class="sidebar-sub-header"><a href="/getting-started/step3.html#_2-通过订阅地址导入" class="sidebar-link">2. 通过订阅地址导入</a></li></ul></li><li><a href="/getting-started/step4.html" class="active sidebar-link">让你的软件或浏览器走 Qv2ray 提供的代理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/getting-started/step4.html#_1-linux" class="sidebar-link">1. Linux</a></li></ul></li><li><a href="/getting-started/step5.html" class="sidebar-link">更多</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="让你的软件或浏览器走-qv2ray-提供的代理"><a href="#让你的软件或浏览器走-qv2ray-提供的代理" class="header-anchor">#</a> 让你的软件或浏览器走 Qv2ray 提供的代理</h1> <p>不同平台的代理配置方式不同。</p> <h2 id="_1-linux"><a href="#_1-linux" class="header-anchor">#</a> 1. Linux</h2> <h3 id="让本机应用使用代理"><a href="#让本机应用使用代理" class="header-anchor">#</a> 让本机应用使用代理</h3> <h4 id="方法一：环境变量"><a href="#方法一：环境变量" class="header-anchor">#</a> 方法一：环境变量</h4> <p>在 Linux 下，有（相当一部分）应用程序（如 curl, wget 等）会遵循形如“协议_proxy”的环境变量所设置的代理。例如：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">http_proxy</span><span class="token operator">=</span><span class="token string">&quot;http://127.0.0.1:8000&quot;</span> <span class="token comment">#将地址和端口换成Qv2ray中配置的http入站对应的地址和端口</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">https_proxy</span><span class="token operator">=</span><span class="token string">&quot;http://127.0.0.1:8000&quot;</span>
</code></pre></div><p>即可让这些程序使用 Qv2ray 的 http 入站代理。</p> <p>如果 Qv2ray 的 http 入站代理启用了身份验证，则相应的环境变量应设为：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">http_proxy</span><span class="token operator">=</span><span class="token string">&quot;http://user:pass@127.0.0.1:8000&quot;</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">https_proxy</span><span class="token operator">=</span><span class="token string">&quot;http://user:pass@127.0.0.1:8000&quot;</span>
</code></pre></div><p>如果身份验证的用户和密码中有特殊字符，则需要对其进行转义，可参考下表：</p> <table><thead><tr><th><code>!</code></th> <th><code>#</code></th> <th><code>$</code></th> <th><code>&amp;</code></th> <th><code>'</code></th> <th><code>(</code></th> <th><code>)</code></th> <th><code>*</code></th> <th><code>+</code></th> <th><code>,</code></th> <th><code>/</code></th> <th><code>:</code></th> <th><code>;</code></th> <th><code>=</code></th> <th><code>?</code></th> <th><code>@</code></th> <th><code>[</code></th> <th><code>]</code></th></tr></thead> <tbody><tr><td><code>%21</code></td> <td><code>%23</code></td> <td><code>%24</code></td> <td><code>%26</code></td> <td><code>%27</code></td> <td><code>%28</code></td> <td><code>%29</code></td> <td><code>%2A</code></td> <td><code>%2B</code></td> <td><code>%2C</code></td> <td><code>%2F</code></td> <td><code>%3A</code></td> <td><code>%3B</code></td> <td><code>%3D</code></td> <td><code>%3F</code></td> <td><code>%40</code></td> <td><code>%5B</code></td> <td><code>%5D</code></td></tr></tbody></table> <p>注：如果需要通过 <code>sudo</code> 执行的程序也使用这些环境变量，需要让 <code>sudo</code> 保留这些环境变量，在<code>sudoers</code>配置文件中加上这一行即可：</p> <div class="language- extra-class"><pre class="language-text"><code>Defaults env_keep += &quot;http_proxy https_proxy ftp_proxy&quot;
</code></pre></div><p>有些程序使用的是自己定义的环境变量，如 <code>rsync</code> 需通过 <code>RSYNC_PROXY</code> 环境变量来使用 http 代理：</p> <div class="language- extra-class"><pre class="language-text"><code>export RSYNC_PROXY=user:pass@127.0.0.1:8000
</code></pre></div><h4 id="方法二：手动设置"><a href="#方法二：手动设置" class="header-anchor">#</a> 方法二：手动设置</h4> <p>有些应用支持手动设置代理。以 Firefox 为例：</p> <p>首选项-常规-网络设置（在最底下）-手动代理配置-把 Qv2ray 的 http 入站代理填到 HTTP/HTTPS/FTP 代理栏里，或把 Qv2ray 的 socks 入站代理填到 SOCKS 代理栏里。</p> <p>对于浏览器而言，还可以通过插件（如 SwitchyOmega）实现更复杂的代理配置，如进一步分流，临时直连等。</p> <p>凡是选项里有提供 http 代理设置的应用，如无意外都可以类似配置以使用 Qv2ray 的 http 入站代理。</p> <p>对 <code>java</code> 应用，可以通过 java 配置项设置代理，如：</p> <div class="language- extra-class"><pre class="language-text"><code>java -Dhttp.proxyHost=127.0.0.1 -Dhttp.proxyPort=8000 -Dhttps.proxyHost=127.0.0.1 -Dhttps.proxyPort=8000 javacommand
#or
java -DsocksProxyHost=127.0.0.1 -DsocksProxyPort=1088 javacommand
</code></pre></div><p>对 <code>ssh</code> 或 <code>scp</code>，可通过 <code>socat</code> 设置代理，如：</p> <div class="language- extra-class"><pre class="language-text"><code>ssh -o &quot;ProxyCommand=socat - PROXY:localhost:%h:%p,proxyport=8000&quot; user@remotehost
</code></pre></div><p>对 <code>electron</code> 系应用(如 Chrome, Simplenote, Notion 等)，可通过<code>--args</code> 设置代理，如：</p> <div class="language- extra-class"><pre class="language-text"><code>simplenote --args --proxy-server=127.0.0.1:1081
</code></pre></div><p>对 <code>git</code>，可通过 <code>config http.proxy</code> 设置代理，如：</p> <div class="language- extra-class"><pre class="language-text"><code>git config --global http.proxy http://127.0.0.1:1081
git config --global https.proxy http://127.0.0.1:1081
</code></pre></div><p>对 <code>snap</code>，可通过 <code>set system proxy.http</code> 设置代理，如：</p> <div class="language- extra-class"><pre class="language-text"><code>sudo snap set system proxy.http=&quot;http://127.0.0.1:1081&quot; 
sudo snap set system proxy.https=&quot;http://127.0.0.1:1081&quot; 
</code></pre></div><h4 id="方法三：gnome系统设置"><a href="#方法三：gnome系统设置" class="header-anchor">#</a> 方法三：GNOME系统设置</h4> <p>目前 Qv2ray 已经支持自动设置 GNOME 系统设置里的系统代理。有些应用（如 Firefox 和 Chromium）会读取并遵循 GNOME 系统设置里的代理配置，对这些应用而言，只需要在 Qv2ray 里启用系统代理即可。</p> <h4 id="方法四：proxychains"><a href="#方法四：proxychains" class="header-anchor">#</a> 方法四：proxychains</h4> <p>对于前三种方式无法生效的应用，可尝试使用 proxychains 进行代理，它通过劫持动态链接库 <code>libc</code> 中的 <code>connect</code> 等函数实现重定向网络链接到代理中。</p> <p>首先安装 <code>proxychains-ng</code>：https://github.com/rofl0r/proxychains-ng</p> <p>随后，编辑 <code>/etc/proxychains.conf</code>（全局）或<code>$HOME/.proxychains/proxychains.conf</code>（用户），将 <code>[ProxyList]</code> 里的代理改成 Qv2ray 的 socks 或 http 入站代理，如：</p> <div class="language- extra-class"><pre class="language-text"><code>[ProxyList]
socks5  127.0.0.1 1088
#or
#http  127.0.0.1 8000
</code></pre></div><p>在终端里使用 <code>proxychains &lt;program&gt;</code> 即可让 <code>proxychains</code> 劫持该应用，以试图让该应用使用代理。</p> <p>由于 proxychains 的原理是劫持动态链接库 <code>libc</code>，因此它对静态链接的应用（如 <code>golang</code> 编译的应用）是无效的。</p> <h3 id="让网络上的其他设备使用代理"><a href="#让网络上的其他设备使用代理" class="header-anchor">#</a> 让网络上的其他设备使用代理</h3> <p>默认情况下，Qv2ray 的代理配置是只监听 <code>127.0.0.1</code> 的地址，即其代理只有本机能够使用，如需让网络上的其他设备使用代理，需要修改这一配置：</p> <ul><li>若希望局域网（内网 ip 环境）或互联网（公网ip环境）中的所有设备都能够使用本机的Qv2ray提供的代理，则在“首选项-入站设置-监听地址”里，把默认的 <code>127.0.0.1</code> 改成 <code>0.0.0.0</code> 即可。</li> <li>若希望几个具有特定 ip 的设备能够使用本机的 Qv2ray 提供的代理，由于 v2ray 的限制，同一个入站不支持监听多个指定的 ip，可以有两种方式解决这个问题：
<ul><li>通过复杂配置，建立多个不同的入站来实现，每个入站分别监听其中的一个 ip。</li> <li>Qv2ray 的入站监听所有 ip（<code>0.0.0.0</code>），在本机设置防火墙，只允许特定 ip 访问Qv2ray 的代理的端口。</li></ul></li></ul> <p>例子：若 ip 为 <code>192.168.0.100</code> 的设备希望使用代理，本机的 ip 为 <code>192.168.0.50</code>。若本机的 Qv2ray 配置了一个端口为 <code>12345</code> 的 http 入站，监听 ip<code>0.0.0.0</code> 或 <code>192.168.0.100</code>，则在 <code>192.168.0.100</code> 的设备上，可通过</p> <div class="language- extra-class"><pre class="language-text"><code>export http_proxy=&quot;http://192.168.0.50:12345&quot;
export https_proxy=&quot;http://192.168.0.50:12345&quot;
</code></pre></div><p>使用此 http 代理（其他使用方式也类似）。</p> <p>注意事项：</p> <ul><li>为让其他设备使用本机的 Qv2ray 提供的代理，除了本机的 Qv2ray 的代理需要监听目标设备的ip之外，还需要让目标设备能通过本机ip及代理端口访问到本机。因此，若本机设置了防火墙，则需要让防火墙放行对应端口；局域网环境里，可能需要关闭“内网隔离”“AP 隔离”之类的设置，否则内网 ip 之间也无法互相访问。</li> <li>如果本机没有设置防火墙，将 Qv2ray 的代理监听的 ip 设为 <code>0.0.0.0</code>，且局域网没有设置“内网隔离”，则意味着局域网里所有的设备都能通过本机的ip及代理端口使用本机的 Qv2ray 提供的代理；如果本机是处于公网ip环境里，则意味着整个互联网中所有设备都能通过本机的 ip 及代理端口使用本机的 Qv2ray 提供的代理。因此，如确需在非可信任的局域网环境或公网 ip 环境中开启此种配置，最好配合防火墙，或配合代理身份验证，以防止本机的代理被滥用。</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Qv2ray/qv2ray.github.io/edit/master/getting-started/step4.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: :</span> <span class="time">3/26/2020, 2:32:54 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/getting-started/step3.html" class="prev">
        向 Qv2ray 中导入节点
      </a></span> <span class="next"><a href="/getting-started/step5.html">
        更多
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.30c44e32.js" defer></script><script src="/assets/js/2.18c3a4c2.js" defer></script><script src="/assets/js/24.6b6e4eef.js" defer></script>
  </body>
</html>
